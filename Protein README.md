# PTM_Proteomic_Analysis
https://github.com/hughcj11/WS40NE_wpPTM_Analysis

The following code works on a csv file downloaded from Skyline, which should contain the following information in this order: Peptide, Protein, Protein Description, Unimod Accession, Peptide Modified Sequence, Begin Pos, End Pos, Average Measured Retention Time, and the Normalized Area of each Replicate. If Skyline is listing replicates one by one in a row instead of columns, check the "Pivot Replicates" button. It is critical that the csv file is ordered this way so that the code reads the correct columns.
    *Note: For this code to work, the Skyline output for Unimod Accession should contain only the peptide sequence and the unimod in (). Any mass shifts that do not have Unimod IDs are displayed in [] and will be removed at this time. This is necessary so that the code can correctly count the residues. To account for these mass shifts without unimod IDs, additional code will need to be written in this file.
To run your specific file, you must first update the base path so that the code can locate your specific data file. Once the base path is updated, all files generated will appear in the same folder as your Skyline data.

Additionally, this code will require a reference library of Unimod IDs and their biological relevance. This document will be referenced in the code as a biological relevance dictionary. BE SURE TO UPDATE THE FILE PATH IN THE CODE to reference your biological relevance dictionary (Line 5). This document should be updated regularly to ensure the information remains accurate.


PTM Analysis: (code files: Cell Proteomics_ID and Cell Proteomics Stastistics)
The following code will generate the following documents using the Skyline csv file: IntermediateSheet, IntermediateSheet2, ProteinPTMLibrary, BioRelevantProteinPTMLibrary, UniqueProteinLibrary, UniqueUnimodLibrary, Replicate calculations, and Replicate calculations Total PTMs.
    
    IntermediatePTMSheet: pulls out all the modifications on each peptide
    
    IntermediatePTMSheet2: will produce hPTM IDs

    UniqueUnimodLibrary: identifies unique unimods+residue found in the dataset. This document can be used to manually update the reference list of hPTMS and their biological relevance. This is not used in any calculations and is only meant to be an aid.

    ProteinPTMLibrary: provides a list of unique modifications found in the data, both biologically relevant and not

    BioRelevantProteinPTMLibrary: provides a list of ONLY biologically relevant/unspecified unique modifications found in the data

    UniqueProteinLibrary: provides a list of unique proteins found in the data

    UniqueResidueLibrary:provides a list of the unique residues that were modified

    Replicate calculations: provides a biologically relevant ProteinPTMLibrary with the relative abundance calculated for each PTM type and protein location for each replicate. This will calculate the "Sample X Modified" (the sum of the normalized area from all protein peptides containing the given protein PTM) and "Sample X All values" (the sum of the normalized area from all protein peptides that contained the amino acid residue, regardless of its modification status, where the given protein PTM was detected). 

    Replicate calculations Total PTMs:provides a biologically relevant ProteinPTMLibrary with the relative abundance calculated for each PTM type regardless of protein location/residue for each replicate.


The code Cell Proteomics Statistics takes the place of the Excel Calculations workbook by calculating the relative abuandance, beta value, and m values of each PTM. Additionally, this code performs stastistics on the unique PTMS and the global PTM changes. The following 6 csv files are generated:

    Full_Relative_Abundance: generates the relative abundance value in a csv file.

    Full_beta_values: generates the beta value in a csv file.

    Full_M_Values: generates the m value in a csv file.


Protein Abundance Analysis: (code files: Cell Proteomics_Abundance)
 The following code will generate the following documents using the Skyline csv file:

     quantile: quantile normalization of data

     SighProteinAbundance: lists all the sig proteins 

     SighProteinAbundanceEnsembleID:lists all the ensemble ids for the sig proteins 

     ProteinsforCLUST: Lists all proteins with their matching EnsembleID.


R Code for Figures:
The code "Cell Proteomics R Code" is used in R to generate abundance maps/PCA plots. It uses the csv files generated by Cell Proteomics Statistics. 
